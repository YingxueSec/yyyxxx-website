---
import Layout from '../layouts/Layout.astro';
import Navbar from './Navbar.astro';
import Footer from './Footer.astro';
import GradientBackground from './GradientBackground.astro';
import ThemeToggle from './ThemeToggle.astro';

interface Badge {
  text: string;
  color: string;
  pulse?: boolean;
}

interface Action {
  text: string;
  href: string;
  external?: boolean;
}

interface Props {
  title: string;
  metaTitle: string;
  metaDescription: string;
  description: string;
  badges: Badge[];
  actions: Action[];
  gradient: { color1: string; color2: string };
  icon: {
    type: 'image' | 'svg';
    src?: string;
    svg?: string;
    bgGradient?: string;
  };
}

const { 
  title, 
  metaTitle,
  metaDescription,
  description, 
  badges, 
  actions,
  gradient,
  icon
} = Astro.props;
---

<Layout title={metaTitle} description={metaDescription}>
  <GradientBackground color1={gradient.color1} color2={gradient.color2} />
  
  <Navbar currentPage="products">
    <ThemeToggle slot="theme-toggle" />
  </Navbar>

  <!-- 产品头部 -->
  <section class="container mx-auto px-6 lg:px-8 py-16">
    <div class="max-w-4xl mx-auto">
      <!-- 返回链接 -->
      <a href="/products" class="inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground mb-8 transition-colors">
        <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
        </svg>
        返回产品列表
      </a>
      
      <!-- 产品信息 -->
      <div class="flex flex-col md:flex-row gap-8 items-start">
        <div class="flex-shrink-0">
          {icon.type === 'image' ? (
            <div class={`w-32 h-32 rounded-2xl ${icon.bgGradient || 'bg-gradient-to-br from-blue-500/10 to-purple-500/10'} border border-blue-500/20 flex items-center justify-center`}>
              <img src={icon.src} alt={title} class="w-24 h-24 rounded-xl" />
            </div>
          ) : (
            <div class={`w-32 h-32 rounded-2xl ${icon.bgGradient || 'bg-gradient-to-br from-blue-500/10 to-purple-500/10'} border border-blue-500/20 flex items-center justify-center`}>
              <Fragment set:html={icon.svg} />
            </div>
          )}
        </div>
        <div class="flex-1">
          <div class="flex items-center gap-3 mb-3">
            <h1 class="text-3xl font-bold">{title}</h1>
            {badges.map(badge => (
              <span class:list={[
                "inline-flex items-center rounded-full px-3 py-1 text-xs font-medium ring-1 ring-inset",
                `bg-${badge.color}-500/10 text-${badge.color}-500 ring-${badge.color}-500/20`,
                badge.pulse && "animate-pulse"
              ]}>
                {badge.text}
              </span>
            ))}
          </div>
          <p class="text-lg text-muted-foreground mb-6">{description}</p>
          <div class="flex flex-wrap gap-3">
            {actions.map((action, i) => (
              <a 
                href={action.href} 
                target={action.external ? "_blank" : undefined}
                class:list={[
                  "inline-flex h-10 items-center justify-center rounded-lg px-6 text-sm font-medium transition-colors",
                  i === 0 
                    ? "bg-primary text-primary-foreground hover:bg-primary/90" 
                    : "border border-border bg-background hover:bg-accent"
                ]}
              >
                {action.text}
              </a>
            ))}
          </div>
        </div>
      </div>
    </div>
  </section>

  <slot />

  <!-- CTA -->
  <slot name="cta">
    <section class="py-16">
      <div class="container mx-auto px-6 lg:px-8">
        <div class="max-w-4xl mx-auto text-center">
          <h2 class="text-2xl font-bold mb-4">立即体验</h2>
          <p class="text-muted-foreground mb-8">加入技术交流群，获取更多产品信息和优惠</p>
          <a href="/#contact" class="inline-flex h-12 items-center justify-center rounded-lg bg-primary px-8 text-sm font-semibold text-primary-foreground transition-colors hover:bg-primary/90">
            联系我们
          </a>
        </div>
      </div>
    </section>
  </slot>

  <Footer backLink={{ href: "/products", text: "← 返回产品列表" }} />
</Layout>
